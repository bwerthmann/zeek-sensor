

# kubectl exec -n zeek sensor -c sensor  -- cat dns.log |jq '.'

#kubectl port-forward service/quickstart-es-http 9200 &

#GET customlogs-generic-default/_search
#{
#  "query": {
#    "bool": {
#      "filter": [
#        {
#          "multi_match": {
#            "type": "phrase",
#            "query": "CiZ3mW1apJPYhdFmp",
#            "lenient": true
#          }
#        }
#      ]
#    }
#  }
#}

(
  export PASSWORD=$(kubectl get secret quickstart-es-elastic-user -o go-template='{{.data.elastic | base64decode}}')
  curl -u "elastic:$PASSWORD" -k "https://localhost:9200/customlogs-generic-default/_search" <<<$(jq -n --arg query CiZ3mW1apJPYhdFmp '{"query": {bool: {filter: [{multi_match: {type: "phrase", query: $query, lenient: true }}]}}}')
)

